#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ุงุฎุชุจุงุฑ ูุจุณุท ูููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู ุนูุฏ ุงูุฎุฑูุฌ
"""

import sys
import os
from pathlib import Path

# ุฅุถุงูุฉ ุงููุฌูุฏ ุงูุฑุฆูุณู ููุชุทุจูู ุฅูู ุงููุณุงุฑ
sys.path.insert(0, str(Path(__file__).parent))

try:
    print("๐งช ุงุฎุชุจุงุฑ ุงุณุชูุฑุงุฏ ุงููุญุฏุงุช...")
    
    # ุงุฎุชุจุงุฑ ุงุณุชูุฑุงุฏ PyQt5
    from PyQt5.QtWidgets import QApplication, QMessageBox
    from PyQt5.QtCore import Qt
    print("โ ุชู ุงุณุชูุฑุงุฏ PyQt5 ุจูุฌุงุญ")
    
    # ุงุฎุชุจุงุฑ ุงุณุชูุฑุงุฏ ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู
    import config
    print("โ ุชู ุงุณุชูุฑุงุฏ config ุจูุฌุงุญ")
    print(f"   AUTO_BACKUP_ON_EXIT = {config.AUTO_BACKUP_ON_EXIT}")
    
    # ุงุฎุชุจุงุฑ ุงุณุชูุฑุงุฏ ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
    from app.main_window import MainWindow
    print("โ ุชู ุงุณุชูุฑุงุฏ MainWindow ุจูุฌุงุญ")
    
    # ุงุฎุชุจุงุฑ ูุฌูุฏ ุงูุฏูุงู ุงููุทููุจุฉ
    if hasattr(MainWindow, 'create_auto_backup_on_exit'):
        print("โ ุฏุงูุฉ create_auto_backup_on_exit ููุฌูุฏุฉ")
    else:
        print("โ ุฏุงูุฉ create_auto_backup_on_exit ุบูุฑ ููุฌูุฏุฉ")
    
    if hasattr(MainWindow, 'closeEvent'):
        print("โ ุฏุงูุฉ closeEvent ููุฌูุฏุฉ")
    else:
        print("โ ุฏุงูุฉ closeEvent ุบูุฑ ููุฌูุฏุฉ")
    
    # ุงุฎุชุจุงุฑ ุฅูุดุงุก ุงูุชุทุจูู ูุงููุงูุฐุฉ
    print("\n๐ ุงุฎุชุจุงุฑ ุฅูุดุงุก ุงูุชุทุจูู...")
    app = QApplication(sys.argv)
    
    # ุฅูุดุงุก ุงููุงูุฐุฉ (ุจุฏูู ุนุฑุถ)
    window = MainWindow()
    print("โ ุชู ุฅูุดุงุก ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ ุจูุฌุงุญ")
    
    # ุงุฎุชุจุงุฑ ุฏุงูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู (ูุญุงูุงุฉ)
    print("\n๐งช ุงุฎุชุจุงุฑ ุฏุงูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู...")
    try:
        # ูุญุงููุฉ ุชุดุบูู ุงูุฏุงูุฉ (ูุฏ ุชูุดู ุจุณุจุจ ุนุฏู ูุฌูุฏ ุจูุงูุงุช ูุนููุฉ)
        result = window.create_auto_backup_on_exit()
        print(f"โ ุชู ุชุดุบูู ุฏุงูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุ ุงููุชูุฌุฉ: {result}")
    except Exception as e:
        print(f"โ๏ธ ุชุญุฐูุฑ ูู ุชุดุบูู ุฏุงูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู: {e}")
        print("   ูุฐุง ุทุจูุนู ุฅุฐุง ูู ุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุฌูุฏุฉ ุฃู Supabase ุบูุฑ ูุชุงุญ")
    
    app.quit()
    print("\nโ ุชู ุงุฎุชุจุงุฑ ุฌููุน ุงูููููุงุช ุจูุฌุงุญ!")
    print("\n๐ฏ ุฎุทูุงุช ุงุฎุชุจุงุฑ ุงูููุฒุฉ ูู ุงูุชุทุจูู ุงููุนูู:")
    print("   1. ูู ุจุชุดุบูู ุงูุชุทุจูู: python main.py")
    print("   2. ุงุถุบุท ุฒุฑ ุงูุฅุบูุงู (โ)")
    print("   3. ูุฌุจ ุฃู ุชุฑู ุฑุณุงูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุชููุงุฆู")
    print("   4. ุงุถุบุท 'ูุนู' ูุงุฎุชุจุงุฑ ุงูููุฒุฉ")
    
except ImportError as e:
    print(f"โ ุฎุทุฃ ูู ุงูุงุณุชูุฑุงุฏ: {e}")
    print("ุชุฃูุฏ ูู ุฃู PyQt5 ูุซุจุช: pip install PyQt5")
except Exception as e:
    print(f"โ ุฎุทุฃ ุนุงู: {e}")

print("\n" + "="*50)
print("ุงูุชูู ุงูุงุฎุชุจุงุฑ")
