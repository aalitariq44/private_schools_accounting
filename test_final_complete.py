#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
ุงุฎุชุจุงุฑ ููุงุฆู ุดุงูู ููุชุตููู ุงูุฌุฏูุฏ
"""

import sys
import os
from pathlib import Path

# ุฅุถุงูุฉ ูุณุงุฑ ุงููุดุฑูุน
project_root = Path(__file__).parent
sys.path.insert(0, str(project_root))

from core.pdf.student_id_generator import generate_student_ids_pdf
from datetime import datetime

def test_full_page():
    """ุงุฎุชุจุงุฑ ุตูุญุฉ ูุงููุฉ ุจู 8 ุทูุงุจ"""
    print("=== ุงุฎุชุจุงุฑ ุตูุญุฉ ูุงููุฉ ูู ุงููููุงุช ุงูุฌุฏูุฏุฉ ===")
    
    # 8 ุทูุงุจ ูููุก ุตูุญุฉ ูุงููุฉ
    students = [
        {"id": 101, "name": "ุฃุญูุฏ ูุญูุฏ ุงูุฃุญูุฏ", "grade": "ุงูุฃูู ุงูุงุจุชุฏุงุฆู", "school_name": "ูุฏุฑุณุฉ ุงูููุฑ ุงูุฃูููุฉ"},
        {"id": 102, "name": "ูุงุทูุฉ ุนูู ุงูุณุนุฏู", "grade": "ุงูุซุงูู ุงูุงุจุชุฏุงุฆู", "school_name": "ูุฏุฑุณุฉ ุงูุฃูู ุงูุฃูููุฉ"},
        {"id": 103, "name": "ูุญูุฏ ุญุณู ุงูุฎุทูุจ", "grade": "ุงูุซุงูุซ ุงูุงุจุชุฏุงุฆู", "school_name": "ูุฏุฑุณุฉ ุงูุดุฑูู ุงูุฃูููุฉ"},
        {"id": 104, "name": "ุฒููุจ ุฃุญูุฏ ุงููุญูุฏู", "grade": "ุงูุฑุงุจุน ุงูุงุจุชุฏุงุฆู", "school_name": "ูุฏุฑุณุฉ ุงููุฌุงุญ ุงูุฃูููุฉ"},
        {"id": 105, "name": "ุนุจุฏุงููู ุณุนุฏ ุงูุฑุงุดุฏ", "grade": "ุงูุฎุงูุณ ุงูุงุจุชุฏุงุฆู", "school_name": "ูุฏุฑุณุฉ ุงูุฑุดูุฏ ุงูุฃูููุฉ"},
        {"id": 106, "name": "ูุฑูู ุนุงุฏู ุงูุจูุฑู", "grade": "ุงูุณุงุฏุณ ุงูุงุจุชุฏุงุฆู", "school_name": "ูุฏุฑุณุฉ ุงููุฌุฏ ุงูุฃูููุฉ"},
        {"id": 107, "name": "ููุณู ุฅุจุฑุงููู ุงูุนูู", "grade": "ุงูุฃูู ุงููุชูุณุท", "school_name": "ูุฏุฑุณุฉ ุงููุฌุฑ ุงูุฃูููุฉ"},
        {"id": 108, "name": "ููุฑ ุงููุฏู ุตุงูุญ", "grade": "ุงูุซุงูู ุงููุชูุณุท", "school_name": "ูุฏุฑุณุฉ ุงููุฏุงูุฉ ุงูุฃูููุฉ"}
    ]
    
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_file = project_root / f"final_design_test_{timestamp}.pdf"
    
    print(f"๐ ุฅูุดุงุก: {output_file.name}")
    print(f"๐ฅ ุนุฏุฏ ุงูุทูุงุจ: {len(students)} (ุตูุญุฉ ูุงููุฉ)")
    
    result = generate_student_ids_pdf(
        students,
        str(output_file),
        "ูุฏุฑุณุฉ ุนุงูุฉ",
        "ูููุฉ ุทุงูุจ"
    )
    
    if result:
        print("โ ุชู ุฅูุดุงุก ุงูููู ุจูุฌุงุญ!")
        print(f"๐ ุญุฌู ุงูููู: {output_file.stat().st_size / 1024:.2f} KB")
        
        print("\n๐ ุงูุทูุงุจ ูู ุงูุตูุญุฉ:")
        for i, student in enumerate(students, 1):
            print(f"  {i}. {student['name']}")
            print(f"     ๐ซ {student['school_name']}")
            print(f"     ๐ {student['grade']} | ๐ {student['id']}")
        
        try:
            os.startfile(str(output_file))
            print(f"\n๐ ุชู ูุชุญ ุงูููู ูููุฑุงุฌุนุฉ ุงูููุงุฆูุฉ")
        except:
            print(f"\nููููู ูุชุญ ุงูููู: {output_file}")
        
        return True
    else:
        print("โ ูุดู ูู ุฅูุดุงุก ุงูููู")
        return False

def test_multiple_pages():
    """ุงุฎุชุจุงุฑ ุนุฏุฉ ุตูุญุงุช"""
    print("\n=== ุงุฎุชุจุงุฑ ุนุฏุฉ ุตูุญุงุช ===")
    
    # 15 ุทุงูุจ ูุงุฎุชุจุงุฑ ุตูุญุชูู
    students = []
    schools = [
        "ูุฏุฑุณุฉ ุงูููุฑ ุงูุฃูููุฉ", "ูุฏุฑุณุฉ ุงูุฃูู ุงูุฃูููุฉ", "ูุฏุฑุณุฉ ุงูุดุฑูู ุงูุฃูููุฉ",
        "ูุฏุฑุณุฉ ุงููุฌุงุญ ุงูุฃูููุฉ", "ูุฏุฑุณุฉ ุงูุฑุดูุฏ ุงูุฃูููุฉ"
    ]
    grades = [
        "ุงูุฃูู ุงูุงุจุชุฏุงุฆู", "ุงูุซุงูู ุงูุงุจุชุฏุงุฆู", "ุงูุซุงูุซ ุงูุงุจุชุฏุงุฆู",
        "ุงูุฑุงุจุน ุงูุงุจุชุฏุงุฆู", "ุงูุฎุงูุณ ุงูุงุจุชุฏุงุฆู", "ุงูุณุงุฏุณ ุงูุงุจุชุฏุงุฆู"
    ]
    
    for i in range(15):
        student = {
            "id": 200 + i,
            "name": f"ุงูุทุงูุจ ุฑูู {i + 1}",
            "grade": grades[i % len(grades)],
            "school_name": schools[i % len(schools)]
        }
        students.append(student)
    
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_file = project_root / f"multi_page_test_{timestamp}.pdf"
    
    result = generate_student_ids_pdf(
        students,
        str(output_file),
        "ูุฏุฑุณุฉ ุนุงูุฉ",
        "ูููุฉ ุทุงูุจ"
    )
    
    if result:
        pages = (len(students) + 7) // 8
        print(f"โ ุชู ุฅูุดุงุก ููู {pages} ุตูุญุงุช ุจูุฌุงุญ!")
        try:
            os.startfile(str(output_file))
        except:
            pass
        return True
    else:
        print("โ ูุดู ูู ุฅูุดุงุก ุงูููู ูุชุนุฏุฏ ุงูุตูุญุงุช")
        return False

def main():
    """ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู ุงูุดุงูู"""
    print("๐จ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู ุงูุดุงูู ููุชุตููู ุงูุฌุฏูุฏ")
    print("=" * 55)
    
    success1 = test_full_page()
    success2 = test_multiple_pages()
    
    print("\n" + "=" * 55)
    if success1 and success2:
        print("๐ ุงูุชูู ุชุทููุฑ ุงูุชุตููู ุงูุฌุฏูุฏ ุจูุฌุงุญ!")
        print()
        print("๐ ููุฎุต ุงูุชุญุณููุงุช:")
        print("  โจ ุนููุงู 'ูููุฉ ุทุงูุจ' ุซุงุจุช ูููุจุฑุฒ ูู ุงูุฃุนูู")
        print("  ๐ซ ุงุณู ูุฏุฑุณุฉ ูู ุทุงูุจ ุธุงูุฑ ุจูุถูุญ")
        print("  ๐ ุฎุทูุท ุฃูุจุฑ ูุฃูุถุญ ููุนูุงููู (ุญุฌู 14 ู 12)")
        print("  ๐ฏ ุชุฑุชูุจ ุงุญุชุฑุงูู ูุน ุชุณููุงุช ูุงุถุญุฉ")
        print("  ๐ ุฃููุงู ุฃูููุฉ ููุชูุงุณูุฉ")
        print("  ๐ ุฎุทูุท ูุงุตูุฉ ููุชูุธูู")
        print("  ๐ฆ ุฅุทุงุฑุงุช ูุญุณููุฉ ูุน ุฃููุงู ุฌูููุฉ")
        print("  ๐ฏ ุญูุธ ุญุฌู ูุงุณุชุฑ ูุงุฑุฏ (85.60 ร 53.98 ูู)")
        print()
        print("๐ ุงููููุงุช ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู!")
    else:
        print("โ ููุงู ูุดููุฉ ุชุญุชุงุฌ ูุฑุงุฌุนุฉ")

if __name__ == "__main__":
    main()
