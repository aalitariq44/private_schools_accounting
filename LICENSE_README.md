# نظام التراخيص - دليل الاستخدام السريع

## 🔒 نظرة عامة
تم تطبيق نظام تراخيص شامل للحماية من المشاركة غير المرخصة للتطبيق.

## 🚀 الخطوات الأولى

### 1. تثبيت المتطلبات
```bash
# تشغيل ملف الInstall للمتطلبات الجديدة
install_license_deps.bat

# أو تثبيت يدوي
pip install cryptography>=41.0.0 requests>=2.31.0
```

### 2. إعداد جدول التراخيص في Supabase
```sql
-- تشغيل هذا الScript في Supabase SQL Editor
-- انظر create_licenses_table.sql للكود الكامل
```

### 3. إنشاء رموز التفعيل
```bash
# استخدام مولد رموز التفعيل
python license_generator.py

# أو إنشاء رمز تجريبي للاختبار
python create_test_code.py
```

## 🔧 كيفية العمل

### عند تشغيل التطبيق:
1. **فحص ملف الترخيص**: يتم فحص وجود ملف `license.json` مشفر
2. **التحقق من الهارد وير**: مقارنة معلومات الجهاز الحالي مع المحفوظة
3. **التفعيل**: إذا لم يوجد ملف صالح، يتم عرض نافذة التفعيل

### معايير القبول:
- ✅ **تطابق 4/4 عناصر**: تشغيل عادي مثالي
- ✅ **تطابق 3/4 عناصر**: تشغيل عادي
- ⚠️ **تطابق 2/4 عناصر**: تشغيل مع تحذير
- ❌ **تطابق أقل من 2/4**: رفض التشغيل

## 📋 عناصر الهارد وير المُفحوصة
1. **اللوحة الأم (Motherboard)**: رقم سيريال اللوحة الأم
2. **المعالج (CPU)**: معرف المعالج الفريد
3. **عنوان MAC**: عنوان الشبكة
4. **القرص الصلب (Drive)**: رقم سيريال القرص الرئيسي

## 🛠️ إدارة التراخيص

### إنشاء ترخيص جديد:
```python
python license_generator.py
# اختيار 1 - إنشاء ترخيص جديد
```

### عرض قائمة التراخيص:
```python
python license_generator.py
# اختيار 2 - عرض التراخيص
```

### إلغاء ترخيص:
```python
python license_generator.py
# اختيار 3 - إلغاء ترخيص
```

## 🔐 الملفات المهمة

| الملف | الوصف |
|-------|--------|
| `core/licensing/license_manager.py` | المدير الرئيسي للتراخيص |
| `core/licensing/hardware_info.py` | جمع معلومات الهارد وير |
| `core/licensing/activation_dialog.py` | واجهة التفعيل |
| `license.json` | ملف الترخيص المشفر (يتم إنشاؤه تلقائياً) |
| `license_generator.py` | أداة إنشاء رموز التفعيل |

## 🚨 ملاحظات مهمة

### للمطورين:
- ✅ مفتاح التشفير ثابت في الكود لجميع المستخدمين
- ✅ فحص الترخيص يحدث تلقائياً عند بدء التطبيق
- ✅ الاتصال بالإنترنت مطلوب فقط للتفعيل الأول

### للمستخدمين:
- 📱 **التفعيل الأول**: يتطلب اتصال إنترنت
- 🔄 **الاستخدام اليومي**: لا يتطلب إنترنت
- 💻 **تغيير الجهاز**: يسمح بتغيير جزئي في المكونات
- 🔄 **إعادة التثبيت**: قد يتطلب إعادة تفعيل

### للدعم الفني:
- 🔍 **استكشاف الأخطاء**: راجع ملف `logs/app.log`
- 🗑️ **إعادة التفعيل**: احذف ملف `license.json`
- 📊 **مراقبة الاستخدام**: راجع جدول `licenses` في Supabase

## 🧪 اختبار النظام

### اختبار كامل:
```bash
python test_license.py
```

### فحص سريع للهارد وير:
```python
from core.licensing.hardware_info import HardwareInfo
h = HardwareInfo()
print(h.get_all_hardware_info())
```

### فحص حالة الترخيص:
```python
from core.licensing import quick_license_check
print("الترخيص صالح:", quick_license_check())
```

## 📞 الدعم
في حالة وجود مشاكل:
1. راجع ملف `LICENSE_SYSTEM.md` للتفاصيل الفنية
2. تحقق من ملفات السجل في مجلد `logs/`
3. تأكد من صحة إعدادات Supabase في `config.py`

---
**تم التطوير بواسطة**: نظام حماية متقدم لحسابات المدارس الأهلية
