# ميزة طباعة قائمة الطلاب في Word

## الوصف
تم إضافة ميزة جديدة تتيح للمستخدمين طباعة قائمة الطلاب في ملف Word (.docx) بالإضافة إلى الطباعة التقليدية HTML.

## المميزات الجديدة

### 1. اختيار نوع الطباعة
- عند الضغط على زر "طباعة قائمة الطلاب"، ستظهر نافذة اختيار نوع الطباعة
- خيارين متاحين:
  - **طباعة HTML/PDF**: الطريقة التقليدية مع معاينة في المتصفح
  - **إنشاء ملف Word**: إنشاء ملف Word قابل للتعديل

### 2. ملف Word المُنتج
- يتم إنشاؤه في مجلد المؤقت بتاريخ ووقت الإنشاء
- يفتح تلقائياً في Microsoft Word
- يحتوي على:
  - عنوان مركزي "قائمة الطلاب"
  - تاريخ ووقت الطباعة
  - معلومات الفلاتر المطبقة
  - إجمالي عدد الطلاب
  - جدول منسق بالأعمدة المحددة
  - تذييل بـ "نظام إدارة المدارس الخاصة"

### 3. تنسيق الجدول
- عناوين الأعمدة بخط عريض ومتوسط
- ترقيم تلقائي للطلاب
- تناسق ألوان وتنسيق مناسب للطباعة
- دعم كامل للنصوص العربية

## كيفية الاستخدام

### الخطوات:
1. انتقل إلى صفحة إدارة الطلاب
2. طبق الفلاتر المطلوبة (المدرسة، الصف، الحالة، إلخ)
3. رتب الطلاب حسب العمود المرغوب (اضغط على عنوان العمود)
4. اضغط على زر "طباعة قائمة الطلاب"
5. في نافذة اختيار الأعمدة، حدد الأعمدة التي تريد طباعتها
6. اضغط "موافق"
7. اختر نوع الطباعة:
   - **HTML/PDF**: للمعاينة السريعة والطباعة المباشرة
   - **Word**: لإنشاء ملف قابل للتعديل والحفظ
8. اضغط "موافق"

### للـ Word:
- سيتم إنشاء الملف وفتحه تلقائياً
- يمكنك تعديل الملف حسب الحاجة
- يمكنك حفظ الملف في أي مكان تريده

## المتطلبات التقنية

### مكتبات Python المطلوبة:
```
python-docx>=0.8.11
```

### ملفات جديدة:
- `core/printing/word_manager.py`: مدير إنشاء ملفات Word
- `ui/dialogs/print_type_dialog.py`: نافذة اختيار نوع الطباعة

### ملفات محدثة:
- `core/printing/print_manager.py`: تحديث دالة طباعة الطلاب
- `ui/pages/students/students_page.py`: تحديث دالة الطباعة المرتبة
- `requirements.txt`: إضافة مكتبة python-docx

## مميزات إضافية

### الترتيب المحفوظ:
- يحتفظ ملف Word بنفس ترتيب الطلاب المعروض في الجدول
- يتضمن معلومات الترتيب في وصف الفلتر

### معلومات الفلتر:
- يعرض جميع الفلاتر المطبقة في الملف
- يتضمن معلومات البحث والترتيب

### المرونة:
- يمكن للمستخدم اختيار أي مجموعة من الأعمدة
- الملف قابل للتعديل بالكامل في Word
- يمكن إضافة المزيد من التفاصيل أو التنسيقات

## استكشاف الأخطاء

### المشاكل الشائعة:

1. **خطأ "مكتبة python-docx غير مثبتة"**:
   - الحل: تشغيل `pip install python-docx`

2. **فشل في فتح ملف Word**:
   - تأكد من وجود Microsoft Word أو تطبيق متوافق
   - الملف موجود في مجلد المؤقت ويمكن فتحه يدوياً

3. **النص العربي غير مُنسق بشكل صحيح**:
   - تأكد من استخدام خط يدعم العربية في Word
   - يمكن تغيير الخط في Word بعد إنشاء الملف

## الإصدارات المستقبلية

### تحسينات مخططة:
- إضافة خيارات تنسيق متقدمة
- حفظ تفضيلات المستخدم لنوع الطباعة
- دعم قوالب Word مخصصة
- إضافة إحصائيات متقدمة في الملف
- دعم تصدير إلى Excel بالإضافة إلى Word

---

تاريخ التحديث: 25 أغسطس 2025
إصدار الميزة: 1.0.0
