@echo off
chcp 65001 >nul
title ุชุญุถูุฑ ูุจูุงุก ุชุทุจูู ูุธุงู ูุญุงุณุจุฉ ุงููุฏุงุฑุณ ุงูุฃูููุฉ

echo =====================================
echo   ุชุญุถูุฑ ูุจูุงุก ุงูุชุทุจูู - ุงูุฅุตุฏุงุฑ ุงููุงูู
echo =====================================
echo.

:: ุงูุชุญูู ูู ูุฌูุฏ Python
python --version >nul 2>&1
if %errorlevel% neq 0 (
    echo โ ุฎุทุฃ: Python ุบูุฑ ูุซุจุช ุฃู ุบูุฑ ููุฌูุฏ ูู PATH
    echo ูุฑุฌู ุชุซุจูุช Python 3.8 ุฃู ุฃุญุฏุซ ูู: https://python.org
    pause
    exit /b 1
)

echo ๐ฆ ุชุญุฏูุซ ุฃุฏูุงุช Python...
python -m pip install --upgrade pip setuptools wheel

echo ๐ฆ ุชุซุจูุช ุงููุชุทูุจุงุช ุงูุฃุณุงุณูุฉ...
pip install pyinstaller pillow

echo ๐ฆ ุชุซุจูุช ูุชุทูุจุงุช ุงูุชุทุจูู...
pip install -r requirements.txt

echo.
echo ๐ง ุชุญุถูุฑ ุงููุดุฑูุน ููุจูุงุก...
python prepare_build.py

if %errorlevel% neq 0 (
    echo โ ูุดู ูู ุชุญุถูุฑ ุงููุดุฑูุน
    pause
    exit /b 1
)

echo.
echo ๐๏ธ ุจุฏุก ุนูููุฉ ุงูุจูุงุก...
echo โฑ๏ธ ูุฐุง ูุฏ ูุณุชุบุฑู 5-10 ุฏูุงุฆู ุญุณุจ ุณุฑุนุฉ ุงูุฌูุงุฒ...
echo.

:: ุจูุงุก ุงูุชุทุจูู
pyinstaller --clean --noconfirm build.spec

if %errorlevel% eq 0 (
    echo.
    echo =====================================
    echo        โ ุชู ุงูุจูุงุก ุจูุฌุงุญ!
    echo =====================================
    echo.
    echo ๐ ูููุน ุงูุชุทุจูู:
    echo %cd%\dist\PrivateSchoolsAccounting\
    echo.
    echo ๐ ููู ุงูุชุดุบูู: PrivateSchoolsAccounting.exe
    echo.
    echo ๐ ูุนูููุงุช ุฅุถุงููุฉ:
    echo - ุงูุชุทุจูู ูุนูู ุนูู ุฌููุน ุฃุฌูุฒุฉ Windows
    echo - ูุง ูุญุชุงุฌ ุฅูู ุชุซุจูุช Python ุนูู ุงูุฌูุงุฒ ุงููุณุชูุฏู  
    echo - ูููู ูุณุฎ ุงููุฌูุฏ ูุงููุงู ุฅูู ุฃู ุฌูุงุฒ ุขุฎุฑ
    echo.
    
    :: ุฅูุดุงุก ููู ุชุนูููุงุช
    echo ุฅูุดุงุก ููู ุงูุชุนูููุงุช...
    (
        echo ุชุนูููุงุช ุชุดุบูู ูุธุงู ูุญุงุณุจุฉ ุงููุฏุงุฑุณ ุงูุฃูููุฉ
        echo ==========================================
        echo.
        echo 1. ุชุฃูุฏ ูู ูุฌูุฏ ุงููุฌูุฏ ูุงููุงู ูู ููุณ ุงูููุงู
        echo 2. ูู ุจุชุดุบูู ููู PrivateSchoolsAccounting.exe
        echo 3. ุฅุฐุง ุธูุฑุช ุฑุณุงูุฉ ูู Windows Defenderุ ุงุฎุชุฑ "Run anyway"
        echo 4. ูููุณุฎ ุฅูู ุฌูุงุฒ ุขุฎุฑุ ุงูุณุฎ ุงููุฌูุฏ ูุงููุงู
        echo.
        echo ูุชุทูุจุงุช ุงููุธุงู:
        echo - Windows 7 ุฃู ุฃุญุฏุซ
        echo - 4 ุฌูุฌุง ุฑุงู ุนูู ุงูุฃูู
        echo - 500 ููุฌุง ูุณุงุญุฉ ูุงุฑุบุฉ
        echo.
        echo ูู ุญุงูุฉ ูุฌูุฏ ูุดุงูู:
        echo - ุชุฃูุฏ ูู ุฅุบูุงู ุจุฑุงูุฌ ุงูุญูุงูุฉ ูุคูุชุงู
        echo - ูู ุจุชุดุบูู ุงูุชุทุจูู ููุฏูุฑ ^(Run as Administrator^)
        echo - ุชุฃูุฏ ูู ุงุชุตุงู ุงูุฅูุชุฑูุช ููุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
    ) > "dist\PrivateSchoolsAccounting\ุชุนูููุงุช ุงูุชุดุบูู.txt"
    
    :: ูุชุญ ูุฌูุฏ ุงูุฅุฎุฑุงุฌ
    echo ๐ ูุชุญ ูุฌูุฏ ุงูุชุทุจูู...
    explorer "dist\PrivateSchoolsAccounting"
    
) else (
    echo.
    echo =====================================
    echo       โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุจูุงุก!
    echo =====================================
    echo.
    echo ๐ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ:
    echo - ููุต ูู ุงููุณุงุญุฉ ุงูุชุฎุฒูููุฉ
    echo - ุชุนุงุฑุถ ูุน ุจุฑุงูุฌ ุงูุญูุงูุฉ  
    echo - ูููุงุช ููููุฏุฉ ูู ุงููุดุฑูุน
    echo.
    echo ๐ก ุงูุญููู ุงูููุชุฑุญุฉ:
    echo 1. ุชุฃูุฏ ูู ูุฌูุฏ ูุณุงุญุฉ ูุงุฑุบุฉ ูุงููุฉ ^(ุนูู ุงูุฃูู 2 ุฌูุฌุง^)
    echo 2. ุฃุบูู ุจุฑุงูุฌ ุงูุญูุงูุฉ ูุคูุชุงู
    echo 3. ูู ุจุชุดุบูู ุงูุฃูุฑ ููุฏูุฑ
    echo 4. ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ูููุงุช ููุชูุญุฉ ูู ุงููุดุฑูุน
)

echo.
echo ๐ ุงูุชูุช ุงูุนูููุฉ
pause
